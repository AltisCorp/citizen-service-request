<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
    <meta charset=utf-8>
    <!--
     | Version 10.1.1
     | Copyright 2012 Esri
     |
     | Licensed under the Apache License, Version 2.0 (the "License");
     | you may not use this file except in compliance with the License.
     | You may obtain a copy of the License at
     |
     |    http://www.apache.org/licenses/LICENSE-2.0
     |
     | Unless required by applicable law or agreed to in writing, software
     | distributed under the License is distributed on an "AS IS" BASIS,
     | WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     | See the License for the specific language governing permissions and
     | limitations under the License.
    -->
    <meta name="viewport" content="initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
    <title>Citizen Service Request</title>
    <link rel="shortcut icon" href="images/logo.ico" />
    <link id="stylesheet" href='http://serverapi.arcgisonline.com/jsapi/arcgis/2.8/js/dojo/dojox/mobile/themes/iPhone/iPhone.css'
        rel='stylesheet' />
    <link href="styles/serviceRequest.css" rel="stylesheet" type="text/css" />
    <link rel="Stylesheet" id="dynamicStyleSheet" />
    <script type="text/javascript" src="js/baseMapGallery.js"></script>
    <link rel="apple-touch-icon" href="images/locgov-iphone-icon.png" />
    <script type="text/javascript">
        djConfig = {
            parseOnLoad: true,
            mblHideAddressBar: false,
            baseUrl: "./",
            modulePaths: { "js": "js" }
        }
    </script>
    <script type="text/javascript" src="http://serverapi.arcgisonline.com/jsapi/arcgis/?v=2.8compact">
    </script>
    <script src="js/infoWindow.js" type="text/javascript"></script>
    <script type="text/javascript" src="js/baseMapGallery.js"></script>
    <script src="js/modernizr-2.5.3.js" type="text/javascript"></script>
    <script type="text/javascript" src="js/locator.js"></script>
    <script type="text/javascript" src="js/utils.js"></script>
    <script type="text/javascript">


        dojo.require("dojox.mobile.parser");
        dojo.require("dojox.mobile");
        dojo.require("dojo.window");
        dojo.require("dojo.date.locale");

        dojo.require("esri.map");
        dojo.require("esri.tasks.geometry");
        dojo.require("esri.tasks.locator");
        dojo.require("esri.tasks.query");
        dojo.require("esri.layers.FeatureLayer");

        dojo.require("mobile.InfoWindow");
        dojo.require("js.config");
        dojo.require("js.date");

        var map; //variable to store map object
        var isiOS = false;
        var isBrowser = false;
        var isMobileDevice = false;
        var serviceRequestmobileLayer; //variable to store service request mobile Layer URL
        var serviceRequestLayerUrl; //variable to store serviceRequest mobile Layer URL
        var isTablet = false;
        var baseMapLayers; //Variable for storing base map layers
        var showNullValueAs; //variable to store the default value for replacing null values
        var mapSharingOptions; //variable for storing the tiny service URL
        var geometryService; //variable to store the Geometry service used for Geo-coding
        var serviceRequestLayerId = "serviceRequestLayerID"; //variable to store service request layer id
        var tempGraphicsLayerId = "tempGraphicsLayerID"; //variable to store temporary graphics request layer id
        var touchStart = false; //flag set for touchStart
        var locatorFields; //Variable for storing configurable address fields
        var enablePhotoUploadiOS; //variable for storing uploading images into iOS devices
        var photoUploadText; //object to store Message displayed for HTML text
        var serviceRequestSymbol; //variable to store service Request Symbol object
        var locatorURL; //variable to store locator URL
        var infoWindowContent; //variable used to store the info window content
        var infoWindowHeader; //variable used to store the info window header
        var infoPopupHeight; //variable used for storing the info window height
        var infoPopupWidth; //variable used for storing the info window width
        var showCommentsTab; //variable used for toggling the comments tab
        var mapPoint;   //variable to store map point
        var serviceRequestCommentsLayerUrl; //variable to store service Request Comments Layer URL
        var formatDateAs; //variable to store date format
        var selectedMapPoint; // variable to store selected map point
        var serviceRequestCommentsLayerId = "serviceRequestCommentsLayerID"; //variable for comment layer
        var infoWindowData; //Variable used for Info window collection
        var locatorMarkupSymbolURL;
        var locatorMarkupSymbol;
        var windowURL = window.location.toString();

        //Function to initialize the map and read data from Configuration file
        function init() {

            esri.config.defaults.io.proxyUrl = "proxy.ashx";        //Setting to use proxy file
            esriConfig.defaults.io.alwaysUseProxy = false;
            esriConfig.defaults.io.timeout = 180000;    //esri request timeout value
            var userAgent = window.navigator.userAgent;

            if (userAgent.indexOf("iPhone") >= 0 || userAgent.indexOf("iPad") >= 0) {
                isiOS = true;
                dojo.byId('trFileUpload').style.display = "none";
            }

            if (userAgent.indexOf("Android") >= 0 || userAgent.indexOf("iPhone") >= 0) {
                isMobileDevice = true;
                dojo.byId('dynamicStyleSheet').href = "styles/mobile.css";
                dojo.byId('divSplashContent').style.fontSize = "15px";

            }
            else if (userAgent.indexOf("iPad") >= 0) {
                isTablet = true;
                dojo.byId('dynamicStyleSheet').href = "styles/tablet.css";
                dojo.byId('divSplashContent').style.fontSize = "14px";
            }
            else {
                isBrowser = true;
                dojo.byId('dynamicStyleSheet').href = "styles/browser.css";
                dojo.byId('divSplashContent').style.fontSize = "11px";

            }

            if (userAgent.indexOf("iPhone") || userAgent.indexOf("iPad")) {
                var pickupref = document.createElement('script');
                pickupref.setAttribute("type", "text/javascript");
                pickupref.setAttribute("src", "js/picup.js");
                document.getElementsByTagName("head")[0].appendChild(pickupref);
            }


            if (dojo.isIE) {
                dojo.byId('fileUploadControl').style.marginLeft = "-175px";
            }

            dojo.connect(dojo.byId("txtAddress"), 'onkeydown', function (evt) {
                if (evt) {
                    var key = evt.which || evt.keyCode;
                    if (key == 13) {
                        if (dojo.coords("divAddressContent").h > 0) {
                            dojo.byId("txtAddress").blur();
                            LocateAddress();
                        }
                    }
                }
            });

            dojo.connect(dojo.byId('txtDescription'), "onfocus", function () {
                dojo.byId("divRequestTypes").style.display = "none";
                dojo.byId("divCreateRequestContentscrollbar_handle").style.position = (dojo.byId("divRequestTypes").style.display == "block") ? "static" : "relative";
            });

            dojo.connect(dojo.byId('txtMail'), "onfocus", function () {
                dojo.byId("divRequestTypes").style.display = "none";
            });

            dojo.connect(dojo.byId('fileUploadControl'), "onfocus", function () {
                dojo.byId("divRequestTypes").style.display = "none";
            });

            if (!Modernizr.geolocation) {
                dojo.byId("tdGeolocation").style.display = "none";
            }
            var responseObject = new js.config();

            baseMapLayers = responseObject.BaseMapLayers;
            mapSharingOptions = responseObject.MapSharingOptions;
            locatorURL = responseObject.LocatorURL;

            dojo.byId("txtAddress").setAttribute("defaultAddress", responseObject.LocatorDefaultAddress);
            dojo.byId("txtAddress").value = dojo.byId("txtAddress").getAttribute("defaultAddress");
            baseMapLayers = responseObject.BaseMapLayers;
            var infoWindow = new mobile.InfoWindow({
                domNode: dojo.create("div", null, dojo.byId("map"))
            });
            if (isMobileDevice) {
                dojo.byId('divCreateRequest').style.display = "none";
                dojo.byId('divInfoContainer').style.display = "none";
                dojo.replaceClass("divAddressContent", "hideContainer", "hideContainerHeight");
                dojo.byId('divAddressContainer').style.display = "none";
                dojo.replaceClass("divCreateRequest", "opacityShowAnimation", "opacityHideAnimation");                dojo.removeClass(dojo.byId('divInfoContainer'), "opacityHideAnimation");
                dojo.removeClass(dojo.byId('divAddressContainer'), "hideContainerHeight");
                dojo.byId('divSplashScreenContent').style.width = "95%";
                dojo.byId('divSplashScreenContent').style.height = "95%";
                dojo.byId("divLogo").style.display = "none";
                dojo.byId('imgDirections').style.display = "none";
                dojo.byId("lblAppName").style.display = "none";
                dojo.byId("lblAppName").style.width = "80%";
            }
            else {
                var imgBasemap = document.createElement('img');
                imgBasemap.src = "images/imgbasemap.png";
                imgBasemap.className = "imgOptions";
                imgBasemap.title = "Switch Basemap";
                imgBasemap.id = "imgBaseMap";
                imgBasemap.style.cursor = "pointer";
                imgBasemap.onclick = function () {
                    ShowBaseMaps();
                }

                dojo.byId("tdBaseMap").appendChild(imgBasemap);
                dojo.byId("tdBaseMap").className = "tdHeader";
                dojo.byId("divSplashScreenContent").style.width = "350px";
                dojo.byId("divSplashScreenContent").style.height = "290px";
                dojo.byId("divAddressContainer").style.display = "block";
                dojo.byId('imgDirections').src = "images/details.png";
                dojo.byId('imgDirections').title = "Details";
                dojo.byId('imgDirections').style.display = "none";
                dojo.byId("divLogo").style.display = "block";
            }
            dojo.byId('imgApp').src = responseObject.ApplicationIcon;
            dojo.byId('divSplashContent').innerHTML = responseObject.SplashScreenMessage;
            dojo.byId('lblAppName').innerHTML = responseObject.ApplicationName;
            dojo.xhrGet(
                    {
                        url: "ErrorMessages.xml",
                        handleAs: "xml",
                        preventCache: true,
                        load: function (xmlResponse) {
                            messages = xmlResponse;
                        }
                    });
            map = new esri.Map("map", {
                slider: true,
                infoWindow: infoWindow
            });
            dojo.connect(map, "onClick", function (evt) {
                map.infoWindow.hide();
                selectedMapPoint = null;
                ShowProgressIndicator();
                setTimeout(function () {
                    dojo.byId("divRequestTypes").style.display = "none";
                    dojo.byId("divInfoDetails").style.display = "none";
                    AddServiceRequest(evt.mapPoint);
                    HideProgressIndicator();
                }, 500);
            });
            ShowProgressIndicator();
            CreateBaseMapComponent();
            locatorFields = responseObject.LocatorFields.split(",");
            serviceRequestCommentsLayerUrl = responseObject.ServiceRequestCommentsLayerURL;
            serviceRequestLayerUrl = responseObject.ServiceRequestLayerURL;
            formatDateAs = responseObject.FormatDateAs;
            serviceRequestmobileLayer = responseObject.ServiceRequestmobileLayerURL;
            showNullValueAs = responseObject.ShowNullValueAs;
            photoUploadText = responseObject.PhotoUploadText;
            enablePhotoUploadiOS = responseObject.EnablePhotoUploadiOS;
            infoPopupHeight = responseObject.InfoPopupHeight;
            infoPopupWidth = responseObject.InfoPopupWidth;
            infoWindowData = responseObject.InfoWindowData;
            infoWindowContent = responseObject.InfoWindowContent;
            infoWindowHeader = responseObject.InfoWindowHeader;
            showCommentsTab = responseObject.ShowCommentsTab;
            locatorMarkupSymbolURL = responseObject.LocatorMarkupSymbolURL;
            geometryService = new esri.tasks.GeometryService(responseObject.GeometryService);
            dojo.connect(map, "onLoad", function () {
                var zoomExtent;
                var extent = GetQuerystring('extent');
                if (extent != "") {
                    zoomExtent = extent.split(',');
                }
                else {
                    zoomExtent = responseObject.DefaultExtent.split(",");
                }
                var startExtent = new esri.geometry.Extent(parseFloat(zoomExtent[0]), parseFloat(zoomExtent[1]), parseFloat(zoomExtent[2]), parseFloat(zoomExtent[3]), map.spatialReference);
                map.setExtent(startExtent);

            });
            dojo.byId('spanAddAttachmentText').innerHTML = photoUploadText;
            dojo.connect(dojo.byId('imgHelp'), "onclick", function () {
                window.open(responseObject.HelpURL);
            });
            MapInitFunction();
            dojo.connect(map, "onExtentChange", function (evt) {
                SetMapTipPosition();
            });
        }

        //function called when map is initialized
        function MapInitFunction() {

            if (dojo.query('.logo-med', dojo.byId('map')).length > 0) {
                dojo.query('.logo-med', dojo.byId('map'))[0].id = "esriLogo";
            }
            else if (dojo.query('.logo-sm', dojo.byId('map')).length > 0) {
                dojo.query('.logo-sm', dojo.byId('map'))[0].id = "esriLogo";
            }


            dojo.addClass("esriLogo", "esriLogo");
            dojo.byId('divSplashScreenContainer').style.display = "block";
            dojo.addClass(dojo.byId('divSplashScreenContent'), "divSplashScreenDialogContent");
            SetSplashScreenHeight();
            if (isMobileDevice) {

                SetAddressResultsHeight();
                SetCommentHeight();
                SetViewDetailsHeight();
                SetCmtControlsHeight();
            }

            dojo.byId("esriLogo").style.bottom = "10px";
            CreateRatingWidget(dojo.byId('commentRating'));
            var glayer = new esri.layers.GraphicsLayer();
            glayer.id = tempGraphicsLayerId;
            map.addLayer(glayer);

            var serviceRequestLayer = new esri.layers.FeatureLayer(isBrowser ? serviceRequestLayerUrl.ServiceURL : serviceRequestmobileLayer.ServiceURL, {
                mode: esri.layers.FeatureLayer.MODE_SNAPSHOT,
                outFields: ["*"],
                id: serviceRequestLayerId,
                displayOnPan: false
            });
            map.addLayer(serviceRequestLayer);

            var handle = dojo.connect(serviceRequestLayer, "onUpdateEnd", function (features) {
                serviceRequestSymbol = serviceRequestLayer.renderer.infos[0].symbol;
                var symbolSize = isBrowser ? 25 : 44;
                locatorMarkupSymbol = (locatorMarkupSymbolURL == "") ? serviceRequestLayer.renderer.infos[0].symbol : new esri.symbol.PictureMarkerSymbol(locatorMarkupSymbolURL, Number(symbolSize), Number(symbolSize));
                CreateRequestTypesList(serviceRequestLayer.fields);
                HideProgressIndicator();
                dojo.disconnect(handle);
            });
            dojo.connect(serviceRequestLayer, "onClick", function (evt) {
                map.infoWindow.hide();
                //For cancelling event propagation
                evt = (evt) ? evt : event;
                evt.cancelBubble = true;
                if (evt.stopPropagation) {
                    evt.stopPropagation();
                }
                ShowProgressIndicator();
                setTimeout(function () {
                    ShowServiceRequestDetails(evt.graphic.geometry, evt.graphic.attributes);
                    HideProgressIndicator();
                }, 700);


            });
            // add comment layer
            var serviceRequestCommentsLayer = new esri.layers.FeatureLayer(serviceRequestCommentsLayerUrl.ServiceURL, {
                mode: esri.layers.FeatureLayer.MODE_SELECTION,
                outFields: ["*"],
                id: serviceRequestCommentsLayerId,
                displayOnPan: false
            });
            map.addLayer(serviceRequestCommentsLayer);
            if (!isMobileDevice) {
                window.onresize = function () {
                    ResizeHandler();
                }
            }
        }
        dojo.addOnLoad(init);
    </script>
</head>
<body onorientationchange="OrientationChanged();">
    <div id="divUploadDialogContainer" class="divUploadDialogContainer" align="center"
        style="display: none;">
        <table cellpadding="0px" cellspacing="0px" style="width: 100%; height: 100%;">
            <tr align="center" valign="middle">
                <td>
                    <div id="divUploadDialog" class="divUploadDialog">
                        <table cellpadding="0px" cellspacing="0px" style="width: 95%; height: 95%;">
                            <tr>
                                <td style="height: 5px;">
                                </td>
                            </tr>
                            <tr>
                                <td style="color: White;">
                                    <span id="spanAddAttachmentText"></span>
                                </td>
                            </tr>
                            <tr>
                                <td style="height: 5px;">
                                </td>
                            </tr>
                            <tr>
                                <td align="center" class="customButton">
                                    <button type="button" id="btnAddPhoto" style="width: 100px;" class="customButtonInner">
                                        Add Photo
                                    </button>
                                    &nbsp;
                                    <button type="button" style="width: 100px;" class="customButtonInner" onclick="CloseUploadDialog();">
                                        Cancel
                                    </button>
                                </td>
                            </tr>
                            <tr>
                                <td style="height: 5px;">
                                </td>
                            </tr>
                        </table>
                    </div>
                </td>
            </tr>
        </table>
    </div>
    <div id="divMainContainer" style="width: 100%; height: 100%;" dojotype="dojox.mobile.View"
        selected="true">
        <div id="map" style="width: 100%; height: 100%;">
        </div>
    </div>
    <div id="divSplashScreenContainer" class="divSplashScreenContainer" style="display: none;">
        <table style="width: 100%; height: 100%;">
            <tr align="center" valign="middle">
                <td>
                    <div id="divSplashScreenContent" class="divSplashScreenContent">
                        <table style="width: 100%;">
                            <tr>
                                <td>
                                    <div id="divSplashContainer" class="divSplashContainer" style="margin-top: 10px;">
                                        <div id="divSplashContent" class="divSplashContent">
                                        </div>
                                    </div>
                                </td>
                            </tr>
                            <tr>
                                <td align="center">
                                    <div style="width: 75px; margin-top: 7px;" class="customButton" onclick="HideSplashScreenMessage();">
                                        <div class="customButtonInner">
                                            <table style="width: 100%; height: 100%;">
                                                <tr>
                                                    <td align="center" valign="middle">
                                                        <center>
                                                            OK</center>
                                                    </td>
                                                </tr>
                                            </table>
                                        </div>
                                    </div>
                                </td>
                            </tr>
                        </table>
                    </div>
                </td>
            </tr>
        </table>
    </div>
    <div id="divLogo" class="divLogo">
        <table style="width: 100%; height: 100%;" cellpadding="2px" cellspacing="2px">
            <tr align="left" style="margin-top: 0px">
                <td valign="top">
                    <img id="imgApp" class="imgApp" />
                </td>
            </tr>
        </table>
    </div>
    <div class="divApplicationHeader" align="right">
        <table cellpadding="0px" cellspacing="0px" class="tableHeader">
            <tr>
                <td id="lblAppName" class="lblAppName" align="left">
                </td>
                <td align="right">
                    <table>
                        <tr>
                            <td align="center" id="Td1" class="tdHeader">
                                <img alt="Settings" src="images/locate.png" class="imgOptions" title="Search" onclick="ShowLocateContainer();"
                                    style="cursor: pointer" />
                            </td>
                            <td align="center" id="tdGeolocation" class="tdHeader">
                                <img alt="Settings" src="images/gps.png" class="imgOptions" title="Locate" onclick="ShowMyLocation();"
                                    style="cursor: pointer" />
                            </td>
                            <td align="center" id="tdBaseMap">
                            </td>
                            <td align="center" class="tdHeader">
                                <img src="images/imgsocialmedia.png" class="imgOptions" title="Share" onclick="ShareLink(true);"
                                    style="cursor: pointer" />
                            </td>
                            <td align="center" id="help" class="tdHeader">
                                <img src="images/help.png" title="Help" id="imgHelp" class="imgOptions" style="cursor: pointer" />
                            </td>
                        </tr>
                    </table>
                </td>
            </tr>
        </table>
    </div>
    <div id="divAddressContainer" align="center" class="divAddressContainer hideContainerHeight"
        style="display: none">
        <table cellpadding="0px" cellspacing="0px" style="width: 100%; height: 100%;">
            <tr align="center" valign="middle">
                <td>
                    <div id="divAddressContent" class="divAddressContent hideContainerHeight">
                        <table class="tblHeader" style="width: 100%;">
                            <tr style="height: 30px;" align="center" valign="top">
                                <td class="tdHeader" align="left" valign="middle" style="padding-left: 8px;">
                                    Search Address
                                </td>
                                <td style="width: 10%;" align="right">
                                    <img src="images/close.png" class="imgOptions" title="Close" style="cursor: pointer;
                                        padding: 0px" onclick="HideAddressContainer();" />
                                </td>
                            </tr>
                        </table>
                        <div id="divAddressResultContainer" style="margin: 5px;">
                            <table style="color: #fff; width: 100%;">
                                <tr>
                                    <td>
                                        <div id="divAddressPlaceHolder" class="divAddressPlaceHolder" align="left">
                                            <input type="text" id="txtAddress" class="txtAddress" onfocus="if(this.setSelectionRange)this.setSelectionRange(this.value.length, this.value.length);" />
                                            <img src="images/locate.png" id="imgLocate" class="imgLocate" style="cursor: pointer"
                                                title="Locate" onclick="LocateAddress();" />
                                        </div>
                                        <div id="divAddressList" class="divAddressList">
                                            <div id="divAddressScrollContainer" class="divAddressScrollContainer" align="left">
                                                <div id="divAddressScrollContent" class="divAddressScrollContent">
                                                    <table id="tblAddressResults" cellpadding="0" cellspacing="2" style="width: 100%;">
                                                    </table>
                                                </div>
                                            </div>
                                        </div>
                                    </td>
                                </tr>
                            </table>
                        </div>
                    </div>
                </td>
            </tr>
        </table>
    </div>
    <div id="divLayerContainer" class="divLayerContainer hideContainerHeight">
        <div id="divLayerHolder" class="divLayerHolder">
            <div id="divLayerContentHolder" class="divLayerContentHolder">
                <div id="layerList">
                </div>
            </div>
        </div>
    </div>
    <div id="divAppContainer" class="divAppContainer hideContainerHeight">
        <div id="divAppHolder" class="divAppHolder">
            <div id="divAppContent">
                <table cellpadding="0px" cellspacing="0px">
                    <tr>
                        <td>
                            <table cellpadding="2px" cellspacing="2px">
                                <tr>
                                    <td align="center" colspan="3" style="color: white;">
                                        Share this map
                                    </td>
                                </tr>
                                <tr>
                                    <td style="width: 30px;" align="center" id="tdFacebook">
                                        <img title="Facebook" class="imgShare" id="imgFacebook" src="images/img_facebook.png"
                                            onclick="Share('facebook')" />
                                    </td>
                                    <td style="width: 30px;" align="center" id="tdTwitter">
                                        <img title="Twitter" class="imgShare" id="imgTwitter" src="images/img_twitter.png"
                                            onclick="Share('twitter')" />
                                    </td>
                                    <td style="width: 30px;" align="center" id="tdMail">
                                        <img title="Email" class="imgShare" id="imgMail" src="images/img_email.png" onclick="Share('mail')" />
                                    </td>
                                </tr>
                            </table>
                        </td>
                    </tr>
                </table>
            </div>
        </div>
    </div>
    <div id="divCreateRequest" align="center" class="divCreateRequest opacityHideAnimation">
        <table cellpadding="0px" cellspacing="0px" style="width: 100%; height: 100%;">
            <tr align="center" valign="middle">
                <td>
                    <div id="divCreateRequestContainer" class="hideContainer divCreateRequestContainer">
                        <table cellpadding="0px" cellspacing="0px" class="tblHeader" style="padding:1px; width: 100%;">
                            <tr style="height: 30px;" align="center" valign="top">
                                <td class="tdHeader" align="left" valign="middle" style="padding-left: 7px; font-weight: bolder;
                                    width: 90%">
                                    Service Request Details
                                </td>
                                <td align="right" style="width: 10%;">
                                    <img src="images/close.png" id="imgClose" class="imgOptions" title="Close" style="cursor: pointer;
                                        padding-right: 1px;" onclick="HideCreateRequestContainer();" />
                                </td>
                            </tr>
                        </table>
                        <div style="height: 2px;">
                        </div>
                        <div align="center" id="divCreateRequestContent" class="divCreateRequestContent">
                            <div id="divCreateRequestScrollContent" class="divCreateRequestScrollContent" style="left: 0px;
                                border: 2px;">
                                <table id="submitTable" class="submitTable" style="color: #fff;"
                                    cellspacing="0px" >
                                    <tr class="trRowStyle">
                                        <td style="padding-top: 2px;" valign="middle" align="left">
                                            Type:
                                        </td>
                                        <td valign="middle" align="left">
                                            <div class="divDropdown" id="divDropdown">
                                                <table cellpadding="0px" cellspacing="0px" style="width:100%;">
                                                    <tr class="divDropDownContainer" id="divDropDownContainer">
                                                        <td style="height: 25px">
                                                            <input type="text" id="txtSelectedRequest" class="txtSelectedRequest" readonly="readonly"
                                                                onclick="ToggleRequestTypesList();" />
                                                        </td>
                                                        <td style="width: 25px; height:25px;">
                                                            <img src="images/dropdown.png" id="imgDropdownCarot" class="imgDropdownCarot" onclick="ToggleRequestTypesList();" />
                                                        </td>
                                                    </tr>
                                                </table>
                                            </div>
                                            <div id="divRequestTypes" class="divRequestTypes">
                                            </div>
                                        </td>
                                    </tr>
                                    <tr class="trTextAreaRowStyle">
                                        <td style="padding-top: 2px;" valign="top" align="left">
                                            Comment:
                                        </td>
                                        <td align="left">
                                            <textarea placeholder="Enter comment" maxlength="250" id="txtDescription" class="txtDescription"
                                                onkeypress="if(dojo.isIE){return ImposeMaxLength(this, 249);}else{return ImposeMaxLength(this, 250);}"></textarea>
                                        </td>
                                    </tr>
                                    <tr class="trRowStyle">
                                        <td style="padding-top: 2px;" valign="middle" align="left">
                                            Name:
                                        </td>
                                        <td align="left">
                                            <input placeholder="Enter name" maxlength="150" type="text" id="txtName" class="txtBox" />
                                        </td>
                                    </tr>
                                    <tr class="trRowStyle">
                                        <td style="padding-top: 2px;" valign="middle" align="left">
                                            Phone:
                                        </td>
                                        <td align="left">
                                            <input placeholder="Enter phone number" type="tel" id="txtPhone" class="txtBox" />
                                        </td>
                                    </tr>
                                    <tr class="trRowStyle">
                                        <td style="padding-top: 2px;" valign="middle" align="left">
                                            Email:
                                        </td>
                                        <td align="left">
                                            <input placeholder="Enter email address" type="text" id="txtMail" class="txtBox" />
                                        </td>
                                    </tr>
                                    <tr id="trFileUpload" class="trRowStyle">
                                        <td style="padding-top: 2px;" valign="middle" align="left">
                                            Attach:
                                        </td>
                                        <td align="left" valign="middle">
                                            <table cellspacing="0" cellpadding="0" style="margin-left: 4px;width:95%;">
                                                <tr>
                                                    <td class="tdAttach">
                                                        <input id="txtFileName" type="text" class="txtFileName" readonly="readonly" style="margin-left: 0px;width:100%" />
                                                    </td>
                                                    <td  class="tdSelect">
                                                        <div id="divFileSelectComponent" class="fileinputs">
                                                            <form id="formFileUplaod" enctype="multipart/form-data" method="POST" >
                                                            <input id="fileUploadControl" class="filehidden" onchange ="SetFileName(this);" size="25"
                                                                type="file" name="attachment" />
                                                            </form>
                                                        </div>
                                                    </td>
                                                </tr>
                                            </table>
                                        </td>
                                    </tr>
                                </table>
                            </div>
                            <div id="spancreateerror" align="left" style="width: 100%; height: 25px; border: 2px;
                                vertical-align:top; padding-top: 0px">
                                <span id="spanServiceErrorMessage" style="color: Yellow; margin-left: 4px; vertical-align:middle;"></span>
                            </div>
                            <div style="height: 2px; width: 100%">
                            </div>
                            <div id="submitDiv" class="submitDiv" style="width: 100%; border: 2px;">
                                <table cellspacing="0px" style="width: 100%; margin-bottom: 10px">
                                    <tr style="height: 15px;">
                                        <td colspan="2" align="center">
                                            <table>
                                                <tr>
                                                    <td>
                                                        <div class="customButton">
                                                            <div class="customButtonInner">
                                                                <table cellpadding="0px" cellspacing="0px" style="width: 100%; height: 100%;">
                                                                    <tbody>
                                                                        <tr>
                                                                            <td valign="middle" align="center" style="width: 75px" id="btnSubmit" onclick="SubmitIssueDetails();">
                                                                                <center>
                                                                                    Submit
                                                                                </center>
                                                                            </td>
                                                                        </tr>
                                                                    </tbody>
                                                                </table>
                                                            </div>
                                                        </div>
                                                    </td>
                                                    <td>
                                                        <div class="customButton">
                                                            <div class="customButtonInner">
                                                                <table cellpadding="0px" cellspacing="0px" style="width: 100%; height: 100%;">
                                                                    <tbody>
                                                                        <tr>
                                                                            <td valign="middle" align="center" style="width: 75px" id="btnCancel" onclick="HideCreateRequestContainer();">
                                                                                <center>
                                                                                    Cancel
                                                                                </center>
                                                                            </td>
                                                                        </tr>
                                                                    </tbody>
                                                                </table>
                                                            </div>
                                                        </div>
                                                    </td>
                                                </tr>
                                            </table>
                                        </td>
                                    </tr>
                                </table>
                            </div>
                        </div>
                    </div>
                </td>
            </tr>
        </table>
    </div>
    <div id="divInfoContainer" align="center" class="divInfoContainer opacityHideAnimation">
        <table cellpadding="0px" cellspacing="0px" style="width: 100%; height: 100%;">
            <tr align="center" valign="middle">
                <td>
                    <div align="left" id="divInfoContent" class="hideContainer divInfoContent">
                        <table id="tblHeader" class="tblHeader" style="width: 100%; padding: 1px" cellpadding="0px"
                            cellspacing="0px">
                            <tr style="height: 30px;" align="center" valign="top">
                                <td align="left" id="tdLabel" valign="middle" style="padding-left: 7px; width: 98%">
                                    <span id="tdInfoHeader" class="tdInfoHeader"></span>
                                </td>
                                <td id="tdImages">
                                    <table cellpadding="0px" cellspacing="0px" align="right">
                                        <tr>
                                            <td id="tdDirections" align="right">
                                                <img class="infoOptions" id="imgDirections" onclick="ShowInfoDirectionsView();" />
                                            </td>
                                            <td id="tdComments" align="right">
                                                <img src="images/comments.png" class="infoOptions" title="Comments" id="imgComments"
                                                    onclick="ShowCommentsView();" />
                                            </td>
                                            <td align="right">
                                                <img src="images/close.png" class="infoOptions" title="Close" style="cursor: pointer;"
                                                    onclick="HideInfoContainer();" />
                                            </td>
                                        </tr>
                                    </table>
                                </td>
                            </tr>
                        </table>
                        <div id="divInfoDetails" class="divInfoDetails" style="color: #fff;">
                            <div id="divInfoDetailsScroll" class="divInfoDetailsScroll">
                                <table id="tblInfoDetails" cellpadding="0px" cellspacing="0px" style="width: 100%;
                                    padding-top: 5px; padding-left: 2px">
                                </table>
                            </div>
                        </div>
                        <div id="divInfoComments" class="divInfoComments" style="color: #fff; display: none;">
                            <div align="left" id="divCommentsView">
                                <table cellpadding="0px" cellspacing="0px" style="height: 35px; cursor: pointer;"
                                    onclick="ShowAddCommentsView();">
                                    <tr align="left">
                                        <td style="width: 37px;">
                                            <img title="" src="images/addcomment.png" class="imgOptions">
                                        </td>
                                        <td>
                                            Add Comment
                                        </td>
                                    </tr>
                                </table>
                            </div>
                            <div id="divCommentsList">
                                <div id="divCommentsContainer" class="divCommentsContainer">
                                    <div id="divCommentsContent" class="divCommentsContent" style="overflow: hidden">
                                    </div>
                                </div>
                            </div>
                            <div id="divAddComment" style="display: none; margin: 2px;">
                                <div id="divCmtIpContainer" class="divCmtIpContainer">
                                    <div id="divCmtIpContent" class="divCmtIpContent" style="overflow: hidden; width: 100%">
                                        <table cellpadding="2px" cellspacing="0px" style="width: 100%;">
                                            <tr style="height: 20px">
                                                <td valign="middle" style="width: 20px">
                                                    Rating
                                                </td>
                                                <td align="left">
                                                    <ul readonly="false" id="commentRating" value="0" numstars="5" style="width: 150px;
                                                        height: 100%; margin: 0px 0px 0px 0px;" />
                                                </td>
                                            </tr>
                                            <tr valign="top">
                                                <td align="left" colspan="2">
                                                    Comment
                                                </td>
                                            </tr>
                                            <tr valign="top">
                                                <td colspan="2">
                                                    <textarea placeholder="Enter comment" maxlength="250" class="txtArea" id="txtComments"
                                                        onkeypress="if(dojo.isIE){return ImposeMaxLength(this, 249);}else{return ImposeMaxLength(this, 250);}"></textarea>
                                                </td>
                                            </tr>
                                            <tr style="height: 25px;">
                                                <td colspan="2" align="left" style="height: 20px;">
                                                    <span id="spanCommentError" style="display: none; color: Yellow; margin-top: 3px;
                                                        word-wrap: break-word;"></span>
                                                </td>
                                            </tr>
                                            <tr>
                                                <td align="center" colspan="2">
                                                    <table>
                                                        <tr>
                                                            <td>
                                                                <div style="width: 75px;" class="customButton" id="btnAddComments" onclick="AddRequestComment();">
                                                                    <div class="customButtonInner">
                                                                        <table style="width: 100%; height: 100%;">
                                                                            <tr>
                                                                                <td align="center" valign="middle">
                                                                                    Submit
                                                                                </td>
                                                                            </tr>
                                                                        </table>
                                                                    </div>
                                                                </div>
                                                            </td>
                                                            <td>
                                                                <div style="width: 75px;" class="customButton" onclick="ResetCommentValues();">
                                                                    <div class="customButtonInner">
                                                                        <table cellpadding="0px" cellspacing="0px" style="width: 100%; height: 100%;">
                                                                            <tr>
                                                                                <td align="center" valign="middle">
                                                                                    Cancel
                                                                                </td>
                                                                            </tr>
                                                                        </table>
                                                                    </div>
                                                                </div>
                                                            </td>
                                                        </tr>
                                                    </table>
                                                </td>
                                            </tr>
                                        </table>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </td>
            </tr>
        </table>
    </div>
    <div id="divLoadingIndicator" class="divLoadingIndicator" style="display: none;">
        <table cellpadding="0px" cellspacing="0px" style="width: 100%; height: 100%;">
            <tr align="center" valign="middle">
                <td>
                    <img src="images/loader.gif" />
                </td>
            </tr>
        </table>
    </div>
</body>
</html>
